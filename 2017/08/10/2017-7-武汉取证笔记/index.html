<!DOCTYPE HTML>
<html>

<head>
	<link rel="bookmark"  type="image/x-icon"  href="/img/logo_miccall.png"/>
	 <link rel="shortcut icon" href="/img/logo_miccall.png">
	
			
    <title>
    Pegases
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/mic_main.css" />
    <link rel="stylesheet" href="/css/dropdownMenu.css" />
    
    	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css" />
    </noscript>

			    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
	
</head>
    
		
<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_solarized.css" />
<link rel="stylesheet" href="/css/typo.css" />
<!-- 文章页 -->
<body class="is-loading">
    <!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">PEGASES</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special" >
            <ul class="menu links" >
			<!-- Homepage  主页  --> 
			<li >
	            <a href="/" rel="nofollow">主页</a>
	        </li>
			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1">分类</a>
	                    <ul class="submenu">
	                        <li>
	                        <a class="category-link" href="/categories/取证/">取证</a></li><li><a class="category-link" href="/categories/技巧/">技巧</a></li><li><a class="category-link" href="/categories/生活/">生活</a>
	                    </ul>
	        </li>
	        
	        <!-- archives  归档   --> 
	        
	        
		        <!-- Pages 自定义   -->
		        
		        <li>
		            <a href="/About/index.html" title="简介">
		                简介
		            </a>
		        </li>
		        
		        <li>
		            <a href="/group/index.html" title="团队">
		                团队
		            </a>
		        </li>
		        
		        <li>
		            <a href="/About/index.html" title="About">
		                About
		            </a>
		        </li>
		        


            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
		            
		                <li><a href="https://github.com/majunnn" class="icon fa-github"><span class="label">GitHub</span></a></li>
		            
		            
		                <li><a href="null" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
		            
		            
		                <li><a href="null" class="icon fa-instagram"><span class="label">Instagram</span></a></li>
		            
		            
		                <li><a href="null#" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
		            
			</ul>
</nav>

        <div id="main" >
            <div class ="post_page_title_img" style="height: 25rem;background-image: url(http://otiye40z7.bkt.clouddn.com/IMG_3787%281%29.JPG);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;" >
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2 >2017.7.武汉取证笔记</h2></a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <h1 id="2017-7-武汉取证笔记"><a href="#2017-7-武汉取证笔记" class="headerlink" title="2017.7.武汉取证笔记"></a>2017.7.武汉取证笔记</h1><hr>
<p>从西安回来之后确实有点忙，整理西安的文件材料，换新电脑重新搭环境，倒腾数据，老人住院，支队长布置的系里的宣传工作，去XJ支队里报道一堆事，总算能静下来写写博客</p>
<h2 id="Day-1"><a href="#Day-1" class="headerlink" title="Day 1"></a>Day 1</h2><p><strong>电子取证司法鉴定程序</strong> </p>
<p>电子取证步骤（了解）：切断物理网络连接  无线干扰  步骤录屏</p>
<p>坏盘</p>
<h3 id="X-ways使用方法与简单练习："><a href="#X-ways使用方法与简单练习：" class="headerlink" title="X-ways使用方法与简单练习："></a>X-ways使用方法与简单练习：</h3><p>针对分区  建立磁盘镜像<br>X-Ways的5个必会操作 </p>
<p>1、    过滤中： *.doc</p>
<p>2、选择分区，右键，浏览递归，显示结果：能够将所有文件夹里的所有的文件展开来看，进行过滤</p>
<p>3、合并过滤：不同类型的过滤（文件类型，大小，时间等）多种条件下进行过滤（同时过滤）</p>
<p>4、快照选项<br>进行磁盘快照——基于文件系统数据结构搜索、基于文件签名搜索、在选定项中搜索</p>
<p>（基于文件系统数据结构搜索是针对格式化过的磁盘）</p>
<h3 id="硬盘："><a href="#硬盘：" class="headerlink" title="硬盘："></a>硬盘：</h3><p>NTFS FAT32 二者删除内容后，格式化内容后的区别</p>
<p>FAT32格式化后恢复内容：基于文件系统数据结构搜索、基于文件签名搜索；NTFS格式化恢复内容：基于文件签名搜索</p>
<p>磁盘内容、分区结构</p>
<p>分区丢失后重建一个分区</p>
<p>工具——磁盘工具——扫描丢失的分区（全部）</p>
<p>•    功能：</p>
<p>•    磁盘镜像</p>
<p>•    文件过滤：文件名、扩展名、真实类型、大小、时间日期….</p>
<p>•    文件预览：文档、图片、媒体，</p>
<p>•    数据恢复：文件、分区、Raid阵列，删除、格式化</p>
<p>•    隐藏的数据：修改扩展名、ADS数据流、嵌入的数据</p>
<p>•    加密的数据：加密文件、加密算法</p>
<p>•    关键词搜索：同步搜索</p>
<p>•    注册表分析：</p>
<p>•    生成报告：</p>
<h4 id="对于以前分析过的案件，如果需要重新审阅，可以点击文件-打开案件，找到存有之前案件的Case文件夹，选择对应的-xfc文件"><a href="#对于以前分析过的案件，如果需要重新审阅，可以点击文件-打开案件，找到存有之前案件的Case文件夹，选择对应的-xfc文件" class="headerlink" title="对于以前分析过的案件，如果需要重新审阅，可以点击文件|打开案件，找到存有之前案件的Case文件夹，选择对应的*.xfc文件"></a>对于以前分析过的案件，如果需要重新审阅，可以点击文件|打开案件，找到存有之前案件的Case文件夹，选择对应的*.xfc文件</h4><p>磁盘：十六进制查看</p>
<p>文件：十六进制查看</p>
<p>预览：查看解析的内容</p>
<p>详细：查看文件属性和描述</p>
<p>缩略图：缩略图方式查看图像</p>
<p>图例说明：解释各种图标、颜色、属性、缩写的含义</p>
<h3 id="X-Ways-Forensics过滤分析："><a href="#X-Ways-Forensics过滤分析：" class="headerlink" title="X-Ways Forensics过滤分析："></a>X-Ways Forensics过滤分析：</h3><p>文件签名可以说是一个文件的ID，系统或者相关程序通过文件签名来识别这个文件所代表的文件类型，一般文件签名会与文件的类型一致，但是某些情况下，用户行为会照成签名损坏、更改，X-Ways内置文件签名表，在磁盘快照时就对所有证据文件的文件签名进行过解析，那么在我们进行分析时，更为看重的其实是那些文件签名不一致的或者不能识别的文件</p>
<p>文件类型：<br>文档：Office，PDF</p>
<p>图片：JPG，TIFF，PNG</p>
<p>压缩：ZIP，RAR，7Z</p>
<p>注册表：NTUSER……</p>
<p>电子邮件：PST，OST，Foxmail</p>
<p>涉及的操作:  (无法发现嫌疑文件时)<br>加载镜像  磁盘快照 恢复数据 解析文档 解析邮件 解析压缩 校验文件类型 过滤时间 过滤文件类型 搜索关键词 预览文件 创建报告</p>
<p>问题1. 磁盘快照后，能在哪看看恢复的所有文件吗</p>
<p>能，过滤筛选中实现</p>
<p>问题2. 分区签名状态设置是否设置正确发现不匹配</p>
<p>能</p>
<p>问题3. 如何完整导出已选择的文件</p>
<p>恢复</p>
<p>问题4. 动手练习：</p>
<p>•    练习使用X-Ways Forensics精确搜索搜索关键字</p>
<p>•    练习使用X-ways Forensics进行条件搜索</p>
<p>•    练习使用X-ways Forensics进行模糊搜索<br>区别在哪？？</p>
<p>问题5：</p>
<p>老师的截屏工具用的是叫什么？</p>
<p>百度截屏</p>
<h2 id="Day-2"><a href="#Day-2" class="headerlink" title="Day 2"></a>Day 2</h2><p>案例分析：ccfc计算机峰会</p>
<p>法证通的使用</p>
<p>伪造邮件的发送以及代理<br>：tool.chacuo.net/mailanonymous/</p>
<p>win注册表路径:<br>c /winows/system32/config<br>c /winows/system32/</p>
<p>命令框：regedit</p>
<p>Usb插拔记录</p>
<p>Windows10的日志记录：修改时间的动作</p>
<p>Application.evtx 运行程序的崩溃，运行</p>
<p>事件ID与XML视图</p>
<p>筛选当前日志：4624（登录） 4616（更改时间）或者1  6005,6006（电脑开机关机，电脑日志服务，默认开机即启动6005服务）  10000（usb插拔记录）</p>
<p>Smbclient 日志可以看到一些ip和时间</p>
<p>Appxdeployment 应用商店安装行为</p>
<p>Powershell 记录执行过得命令 下划线</p>
<p>Dhcp 有连接过得WiFi信息</p>
<h3 id="QQ目录："><a href="#QQ目录：" class="headerlink" title="QQ目录："></a>QQ目录：</h3><p>找到以qq进行检索</p>
<p>Image为图片（废话）</p>
<p>Msg3.0.db qq聊天记录数据库位置  msg2.0（以前）</p>
<p>Filerecv mobile file \手机信息</p>
<p>###　BaiduYun guanjia</p>
<p>上传下载的目录：baiduyunguanjia.db  sqllite文件夹下<br>用SQLlite数据库查看  《sqllite expert》</p>
<h3 id="将来方向："><a href="#将来方向：" class="headerlink" title="将来方向："></a>将来方向：</h3><p>Python取证 </p>
<p>Powershell取证</p>
<p>Linux取证 ：base</p>
<p>Win10取证：</p>
<p>用户登录头像</p>
<p>文件浏览器搜索记录</p>
<p>用户固定到任务栏的APP</p>
<p>ESE数据库，最新的Windows数据库</p>
<p>VHD镜像文件（Windows默认）</p>
<p>Edge </p>
<p>Cortana</p>
<p>Autopsy（开源）</p>
<p>Paladin（取证系统）</p>
<h2 id="Day-3"><a href="#Day-3" class="headerlink" title="Day 3"></a>Day 3</h2><h3 id="X-ways，搜索浏览器浏览记录-检索Index-dat步骤如下"><a href="#X-ways，搜索浏览器浏览记录-检索Index-dat步骤如下" class="headerlink" title="X-ways，搜索浏览器浏览记录 检索Index.dat步骤如下:"></a>X-ways，搜索浏览器浏览记录 检索Index.dat步骤如下:</h3><p>•    浏览器历史记录文件：    Index.dat</p>
<p>•    位置： \Documents and Settings\Administrator\Local Setting\    </p>
<p>•    查找方法：过滤文件名index.dat，查看路径，查看时间和文件大小，预览</p>
<h3 id="Firefox浏览器历史记录："><a href="#Firefox浏览器历史记录：" class="headerlink" title="Firefox浏览器历史记录："></a>Firefox浏览器历史记录：</h3><p>•    浏览器历史记录文件： places.sqlite    </p>
<p>•    位置： \Documents and Settings\Administrator\Application Data\Mozilla\Firefox</p>
<p>Firefox自动完成表单：formhistory.sqlite</p>
<p>Firefox个人帐户登陆历史记录表单： signons.sqlite</p>
<p>Firefox下载记录表单： downloads.sqlite</p>
<h3 id="搜狗浏览器"><a href="#搜狗浏览器" class="headerlink" title="搜狗浏览器"></a>搜狗浏览器</h3><p>•    浏览器历史记录文件：    HistoryUrl.db</p>
<p>•    位置： \Documents and Settings\Administrator\Application Data\SogouExplorer    </p>
<p>•    查找方法：过滤文件名，过滤目录名，手工切换至此目录</p>
<h3 id="wireshark抓包，分析一个网站时，从域名通过dns协议，转化为一个IP"><a href="#wireshark抓包，分析一个网站时，从域名通过dns协议，转化为一个IP" class="headerlink" title="wireshark抓包，分析一个网站时，从域名通过dns协议，转化为一个IP"></a>wireshark抓包，分析一个网站时，从域名通过dns协议，转化为一个IP</h3><p>三次握手<br>文件-导出对象-</p>
<h3 id="苹果系统："><a href="#苹果系统：" class="headerlink" title="苹果系统："></a>苹果系统：</h3><p>Dock 下面的菜单栏</p>
<p>苹果计算机文件系统 HFS文件系统恢复</p>
<p>.FSeventsd 此目录下，文件日志</p>
<p>Find my iPhone 远程擦除  屏蔽无线信号 切断物理网络</p>
<p>询问密码</p>
<p>尝试利用Inception破解密码</p>
<p>获取物理内存 RECON for mac os x或Inception（macos 10.8）</p>
<p>硬关机 长按电源键按住电源按钮  台式机 拔下电源线 </p>
<p>虚拟机与16个虚拟桌面</p>
<p>查看版本的目录</p>
<p>时区 mac地址 启动项 系统设置  蓝牙 备份文件 TIME Machine 防火墙 打印机 最后休眠时间 com.spple.finder 键盘 最后登录用户 最后更新 的目录<br>\</p>
<p>苹果取证工具:</p>
<p>Paladin pro</p>
<p>八爪鱼</p>
<p>CFLAB 启动磁盘</p>
<p>MacQuisition</p>
<p>麦克磁盘镜像</p>
<p>麦克文件复制</p>
<p>Copycat Extreme</p>
<p>Carbon Copy Cloner</p>
<h2 id="Day-4"><a href="#Day-4" class="headerlink" title="Day 4"></a>Day 4</h2><p>数据恢复就是针对文件系统的分析</p>
<p>GPT下ext4和FAT16/32 </p>
<p>所有的数据都存在ext4下，</p>
<p>物理镜像 ext4的文件系统 分四块 </p>
<p>扇区512  非标准的510（可转）  碎片</p>
<p>碎片整体，提高磁盘性能容量 </p>
<p>Ext2无日志  ext3有日志，日志是不全 ext4日志更全，存量更大</p>
<p>格式化  </p>
<p>比如flex_bg包含4个块组，块组0将按序包含超级块、块组描述符表、块组0-3的数据块位图、块组0-3的inode位图、块组0-3的inode表，块组0中的其他空间用于存储文件数据。同时，其他块组上的数据块位图、inode位图、inode表元数据就不存在了，但是SB和GDT还是存在的。</p>
<p>Fat的格式化恢复远比ntfs完善</p>
<p>X-ways：</p>
<p>数据恢复中，注意丢失的分区，第一步，分区的扫描，第二步才是磁盘快照<br>先看看*.lnk  非常有用，看看这群人都做了什么事</p>
<p>ADS数据流 （NTFS数据流）</p>
<p>type 2.ppt &gt;  1.txt:2.ppt</p>
<p>type 1.txt &gt;4.jpg:1.txt</p>
<p>dir /a /r</p>
<p>notepad 4.jpg:1.txt</p>
<p>：查看方法，1.文件属性过滤ads</p>
<p>浏览 </p>
<p>$J 在目录 $entend/$Usn.Jrnl  目录下</p>
<p>详细记录了win下各种操作（粉碎机与擦除软件无法删除留下证据）</p>
<p>2.Cmd下 dir  /r 查看数据流文件</p>
<p>法证通可看，$J下 打开了哪些文件，以及这些文件的目录</p>
<p>取证-windows取证-文件信息-磁盘日志文件 查看具体操作信息 </p>
<p>是否与图种一致，以及是否可以通过binwalk和foremost分离有待考证 </p>
<p>$Logfile  临时文件交互 ，浏览删除的文件，保证稳定性</p>
<p>存储工具中多个$文件统一记录更新时间 可能就是格式化时间 </p>
<p>wps.bkl</p>
<p>方法1 直接全盘过滤lnk文件 从lnk文件，查看什么时间访问了什么盘，光驱，U盘 路径 </p>
<p>方法2<br>jumplist  跳转文件，主要历史最近使用的文件<br>方法，可以通过磁盘快照，将*.automaticDestinations-ms文件进行磁盘快照提取，可以查看其下文件<br>路径： </p>
<p>可以查看访问记录，文件路径，以及访问时间，访问的盘，光碟，U盘</p>
<p>法证通 中，-win内 - 系统痕迹    过滤与时间排序 </p>
<p>打印痕迹 ：<br><em>.Shd与</em>.spl</p>
<p>上网记录 IE 文件信息  最好用法证通和取证大师  </p>
<p>邮箱 比如Foxmail 可以把文件软件导出，然后在本机运行 仿真进行查看  </p>
<p>一个案子上来<br>法证通 汇总报告，利用好法证通的分析 用户行为分析 </p>
<p>局域网传文件 HFS、</p>
<p>广州反恐案案例<br>大获全胜</p>
<p>反思：<br>图片备注，人物关系思维导图， 截图规范化，物理固定设备信息不完善 </p>
<h2 id="Day-5"><a href="#Day-5" class="headerlink" title="Day 5"></a>Day 5</h2><h3 id="注册表："><a href="#注册表：" class="headerlink" title="注册表："></a>注册表：</h3><p>Ntuser </p>
<p>Sam</p>
<p>Security</p>
<p>Software</p>
<p>利用Registry Report 导出数据报告 </p>
<p>最近打开的 文件记录  注册表</p>
<p>设备信息 （devices） USB 接入信息 </p>
<p>查看注册表，证明，信息，F盘为U盘 </p>
<p>Foxmail 7.2之前还用.box</p>
<p>目录名与文件扩展名</p>
<p>发送接收抄送三者  </p>
<p>Ads数据流带附件 </p>
<p>残留的网页分析 </p>
<p>调用第三方工具EditPlus</p>
<p>搜索网页邮件的关键词：</p>
<p>•    readmail</p>
<p>•    mail_list</p>
<p>•    Mail</p>
<p>•    Readbody</p>
<p>•    readtemplate    </p>
<p>•    Register</p>
<p>•    Compose</p>
<p>•    Send<br>Read  </p>
<p>苹果Mac下</p>
<p>系统痕迹 bash history 系统执行的命令行  最近打的命令 </p>
<p>系统痕迹，磁盘工具保存为：加载过得镜像 有没有安装虚拟机 </p>
<p>Mac虚拟机 virtual box  </p>
<p>手机助手，手机备份 manifest.plist   iTunes 备份文件   ？？？存疑 </p>
<p>苹果备份文件的导出 </p>
<p>最近访问的文档 </p>
<p>NTFS 数据的过滤 搜索 、</p>
<p>法证通 精通 win 和mac、 linux稍弱，</p>
<p>恢复数据之后  解析元数据，解析邮件 解析压缩文件  提取嵌入的数据 提取时间信息 加密文件检测</p>
<p>全盘索引 </p>
<p>同时，开启双份 X-ways 分别进行不同的操作 </p>
<p>法证通的快速报告 </p>
<p>（鉴证大师？）</p>
<p>对时间的具体分析 时间信息的分析 时间线 注册表时间 文件时间属性<br>Ost  box eml emlx  邮件过滤 </p>
<p>常用的过滤 过滤的勾选列表可以保存 （可直接调用 ）</p>
<p>过滤可勾选 选择文件大小 </p>
<p>分布拒绝攻击 ：CC工具 </p>
<p>磁盘别名 </p>
<p>注册表信息不太会  </p>
<hr>
<p><strong>原创文章，转载请注明：</strong>转载自<a href="http://pegase.top/">Pegases’s Blog</a></p>

            </div>

            <!-- Post Comments -->
            
    <!-- 使用 DISQUS_CLICK -->
<div id="disqus-comment">
    <div id="disqus_thread"></div>

<!-- add animation -->
<style>
	.disqus_click_btn {
            line-height: 30px;
            margin: 0;
            min-width: 50px;
            padding: 0 14px;
            display: inline-block;
            font-family: "Roboto", "Helvetica", "Arial", sans-serif;
            font-size: 14px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0;
            overflow: hidden;
            will-change: box-shadow;
            transition: box-shadow .2s cubic-bezier(.4, 0, 1, 1), background-color .2s cubic-bezier(.4, 0, .2, 1), color .2s cubic-bezier(.4, 0, .2, 1);
            outline: 0;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            vertical-align: middle;
            border: 0;
            background: rgba(158, 158, 158, .2);
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);
            color: #fff;
            background-color: #7EC0EE;
            text-shadow: 0
        }
</style>
	
<div class="btn_click_load" id="disqus_bt"> 
    <button class="disqus_click_btn">点击查看评论</button>
</div>

<!--
<script type="text/javascript">
$('.btn_click_load').click(function() {
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'http-miccall-tech'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    document.getElementById('disqus_bt').style.display = "none";
});
</script>
-->
<script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://pegase.top/2017/08/10/2017-7-武汉取证笔记/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'http://pegase.top/2017/08/10/2017-7-武汉取证笔记/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
</script>

<script type="text/javascript">
    $('.btn_click_load').click(function() {  //click to load comments
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document;
            var s = d.createElement('script');
            s.src = '//http-miccall-tech.disqus.com/embed.js';
            s.setAttribute('data-timestamp', + new Date());
            (d.head || d.body).appendChild(s);
        })();
        $('.btn_click_load').css('display','none');
    });
</script>
</div>
<style>
    #disqus-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>


        </div>
        <!-- Copyright 版权 start -->
                <div id="copyright">
            <ul>
                <li>&copy;Powered By <a href="https://hexo.io/zh-cn/" style="border-bottom: none;">hexo</a></li>
                <li>Design: <a href="http://miccall.tech " style="border-bottom: none;">miccall</a></li>
            </ul>
            
            	<span id="busuanzi_container_site_pv">2017总访问量<span id="busuanzi_value_site_pv"></span>次</span>
			
        </div>
    </div>
</body>



 	
</html>
